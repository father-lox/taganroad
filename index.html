<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin=""/>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDxvXuznL3aWv-ISWr9I5nPIcI5Pv0jWgU&libraries=&v=weekly"
    ></script>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
    integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    crossorigin=""></script>
    
    <title>Taganroad</title>
</head>
<body>
    
    <aside class="bar">
        <header>
            <a class="logo" href="index.html"><h1>Taganroad</h1></a>
            <img src="img/sing-in.svg" alt="Регистрация/Авторизация">
        </header>
      
        <nav>
            <ul>
                <a href="#tab-transport" class="tab"><li>Маршрут</li></a>
                <a href="#tab-about-transport" class="tab"><li>Информация</li></a>
                <a href="#tab-popular-place" class="tab"><li>Места</li></a>
            </ul>
         </nav>
        <section class="section-item" open-by-tab="tab-transport">
            <div class="section-title">
                <h2>Маршрут</h2>
            </div>
            <div class="content">
                <form class="route">
                    <div class="form-group">
                        <label>
                            <input type="text" name="from" id="from" placeholder=" " >
                            <span class="help-message">Введите адрес отправления (A)</span>
                        </label>
                        <button type="button" point="departure" id="buttonA">auto</button>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="text" name="to" id="to" placeholder=" ">
                            <span class="help-message">Введите адрес прибытия (B)</span>
                        </label>
                        <button type="button" point="arrival" id="buttonB">auto</button>    

                    </div>
                </form>
                <button onclick = "CreateRoute()" type="button">Построить маршрут</button>
            </div>
        </section>
            <section id="transport" class="section-item" open-by-tab="tab-transport">
                <div class="section-title">
                    <h2>Транспорт</h2>
                    <select>
                        <option selected>все</option>
                        <option>трамвай</option>
                        <option>автобус</option>
                        <option>метро</option>
                        <option>троллейбус </option>
                    </select>
                </div>
                <div class="content">
                    <div class="transport-item">
                        <div class="header-list">
                            <img class="img-list" src="img/alpha-list.svg" alt="Развернуть список">
                            <label class="spoiler">
                                    <h3>№8 Трамвай</h3>
                                    <div class="base-info">
                                        <span>Статус: активен</span>
                                        <span>Время движения: 06:00-22:30</span>
                                    </div>
                                    <div class="time-interval">
                                        <span>14:20</span>
                                        <span>14:30</span>
                                        <span>14:40</span>
                                    </div>
                                    <input type="checkbox" name="route-number">
                            </label>
                        </div>
                        <div class="body-list">
                            <label class="body-list-item">
                                <input type="checkbox" name="s" id="">
                                <span class="icon-check"></span>
                                <div class="about-transport">
                                    <h4>Номер машины 19</h4>
                                    <div class="base-info">
                                        <span>Местоположение: улица Энгельса</span>
                                    </div>
                                    <div class="time-interval">
                                        <span>15:20</span>
                                        <span>16:30</span>
                                        <span>17:40</span>
                                    </div>
                                </div>
                            </label>
                            <label class="body-list-item">
                                <input type="checkbox" name="s" id="">
                                <span class="icon-check"></span>
                                <div class="about-transport">
                                    <h4>Номер машины 19</h4>
                                    <div class="base-info">
                                        <span>Местоположение: улица Энгельса</span>
                                    </div>
                                    <div class="time-interval">
                                        <span>15:20</span>
                                        <span>16:30</span>
                                        <span>17:40</span>
                                    </div>
                                </div>
                            </label>
                            <label class="body-list-item">
                                <input type="checkbox" name="s" id="">
                                <span class="icon-check"></span>
                                <div class="about-transport">
                                    <h4>Номер машины 19</h4>
                                    <div class="base-info">
                                        <span>Местоположение: улица Энгельса</span>
                                    </div>
                                    <div class="time-interval">
                                        <span>15:20</span>
                                        <span>16:30</span>
                                        <span>17:40</span>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>
                    <div class="transport-item">
                        <div class="header-list">
                            <img class="img-list" src="img/alpha-list.svg" alt="Развернуть список">
                            <label class="spoiler">
                                    <h3>№8 Трамвай</h3>
                                    <div class="base-info">
                                        <span>Статус: активен</span>
                                        <span>Время движения: 06:00-22:30</span>
                                    </div>
                                    <div class="time-interval">
                                        <span>14:20</span>
                                        <span>14:30</span>
                                        <span>14:40</span>
                                    </div>
                                    <input type="checkbox" name="route-number">
                            </label>
                        </div>
                        <div class="body-list">
                            <label class="body-list-item">
                                <input type="checkbox" name="s" id="">
                                <span class="icon-check"></span>
                                <div class="about-transport">
                                    <h4>Номер машины 19</h4>
                                    <div class="base-info">
                                        <span>Местоположение: улица Энгельса</span>
                                    </div>
                                    <div class="time-interval">
                                        <span>15:20</span>
                                        <span>16:30</span>
                                        <span>17:40</span>
                                    </div>
                                </div>
                            </label>
                            <label class="body-list-item">
                                <input type="checkbox" name="s" id="">
                                <span class="icon-check"></span>
                                <div class="about-transport">
                                    <h4>Номер машины 19</h4>
                                    <div class="base-info">
                                        <span>Местоположение: улица Энгельса</span>
                                    </div>
                                    <div class="time-interval">
                                        <span>15:20</span>
                                        <span>16:30</span>
                                        <span>17:40</span>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </section>
            <section id="about-transport" class="section-item"  open-by-tab="tab-about-transport">
                <div class="section-title">
                    <h2>О транспорте</h2>
                    <!-- Выполнить стилизацию -->
                    <select>
                        <option selected>все</option>
                        <option>трамвай</option>
                        <option>автобус</option>
                        <option>метро</option>
                        <option>троллейбус </option>
                    </select>
                </div>
                <div class="content">
                    <div class="transport-item">
                        <div class="header-list">
                            <img class="img-list" src="img/alpha-list.svg" alt="Развернуть список">
                            <div class="spoiler">
                                    <h3>№8 Трамвай</h3>
                                    <div class="base-info">
                                        <span>Время движения: 06:00-22:30</span>
                                        <span>Периуд движения: 30 минут</span>
                                        <span>Стоимость проезда: до 20 рублей</span>
                                        <span>Льготы: есть</span>
                                        <span>Статус: активен</span>
                                    </div>
                                </div>
                        </div>
                        <div class="body-list">
                            <div class="body-list-item">
                                <span class="icon-check"></span>
                                <div class="about-transport">
                                    <h4>Номер машины 19</h4>
                                    <div class="base-info">
                                        <span>Местоположение: улица Энгельса</span>
                                        <span>Статус: активен</span>
                                        <span>Период движения: 2 часа</span>
                                        <span>Эксплуатируется с 1932 года</span>
                                        <span>Количество мест: 53</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="section-item"  open-by-tab="tab-popular-place">
                <div class="section-title">
                    <h2>Популярные места</h2>
                    <!-- Выполнить стилизацию -->
                    <select>
                        <option selected>все районы</option>
                        <option>южный</option>
                        <option>центральный</option>
                        <option>восточный</option>
                        <option>заподный</option>
                        <option>сверный</option>
                    </select>
                </div>
                <div class="content">
                    <div class="place-item">
                        <div class="place-photo">
                            <img src="img/photo/city2.jpg" alt="Центральный рынок">
                        </div>
                        <div class="place-description">
                            <h3>Центральный рынок</h3>
                            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Laudantium, voluptate deleniti! Blanditiis, doloribus placeat suscipit id architecto obcaecati ex cum odio alias. Vero voluptatem officiis eum laudantium temporibus inventore totam?</p>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="text" placeholder=" ">
                                <span class="help-message">Введите адрес отправления (A)</span>
                            </label>
                            <button type="button" point="departureplaces" id="buttonPlaces">auto</button>
                        </div>
                        <div class="path">
                            <div class="action">
                                <img src="img/footstep.svg" alt="Идти пешком">
                                <span>Пройти пешком до трамвайной остановки на пер. Некрасовском</span>
                            </div>
                            <div class="action">
                                <img src="img/alpha-tram.svg" alt="Идти пешком">
                                <span>Сядте на трамвай маршрута №2 в направлении "Центр"</span>
                            </div>
                            <div class="action">
                                <img src="img/alpha-tram.svg" alt="Идти пешком">
                                <span>Выйдете на остановке "Центральный рынок"</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
    </aside>

    <main class="map">
        <div id = "map" ></div>
        <script>
            
           // Creating map options
           var mapOptions = {
              center: [47.221965, 38.910854],
              zoom: 13  
           }
           
           // Creating a map object
           var map = new L.map('map', mapOptions);
           
           // Creating a Layer object
           var layer = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
           
           // Adding layer to the map
           map.addLayer(layer);

function CreateRoute() {
    var startCoordinates = [];
var endCoordinates = [];
    const geocoder = new google.maps.Geocoder();
    const startAddress = document.getElementById("from").value + " Таганрог";
    const endAddress = document.getElementById("to").value + " Таганрог";

  geocoder.geocode(
    {
      address: startAddress
    },
    (results, status) => {
        console.log(results[0]);
        startCoordinates[0] = results[0].geometry.location.lat();
        startCoordinates[1] = results[0].geometry.location.lng();

        });

    geocoder.geocode(
    {
      address: endAddress
    },
    (results, status) => {
        console.log(results[0]);
        endCoordinates[0] = results[0].geometry.location.lat();
        endCoordinates[1] = results[0].geometry.location.lng();

        });   

      setTimeout(function() {
        var request = new XMLHttpRequest();
        console.log(startCoordinates[0]);
        console.log(startCoordinates[1]);
        request.open('GET', `https://api.openrouteservice.org/v2/directions/driving-car?api_key=5b3ce3597851110001cf6248d682833474fb4806ad8717782a657f2c&start=${startCoordinates[1]},%20${startCoordinates[0]}&end=${endCoordinates[1]},%20${endCoordinates[0]}`);
        request.setRequestHeader('Accept', 'application/json, application/geo+json, application/gpx+xml, img/png; charset=utf-8');
        console.log("Выше коорды");
        console.log(startCoordinates[0]);
        request.onreadystatechange = function () {
        if (this.readyState === 4) {
            var obj = JSON.parse(this.responseText);
            console.log(this.responseText);
            for (i in obj.features[0].geometry.coordinates) {
                var temp = obj.features[0].geometry.coordinates[i][0];
                obj.features[0].geometry.coordinates[i][0] =  obj.features[0].geometry.coordinates[i][1];
                obj.features[0].geometry.coordinates[i][1] = temp;
            }
            var polyline = L.polyline(obj.features[0].geometry.coordinates, {color: 'green'}).addTo(map);
            map.fitBounds(polyline.getBounds());
        }
        };
         request.send();
                }, 1000);

//end
}


        </script>
    </main>
    <header id="mobile-header">
        <a class="logo" href="index.html"><h1>Taganroad</h1></a>
        <img src="img/sing-in.svg" alt="Регистрация/Авторизация">
    </header>
    <script src="script.js"></script>


</body>
</html>